<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="../css/theme-default-easytable.css"/>
    <link rel="stylesheet" href="../css/my.css"/>
    <script src="../js/config.js"></script>
    <script src="../js/Sortable.js"></script>
    <script src="../js/vue.min.js"></script>
    <script src="../js/axios.min.js"></script>
</head>
<body>
<div id="app" style="font-size: 12px;">
    <div class="ve-table">
        <div class="ve-table-container ve-table-border-around" id="vDiv" style="max-height: 900px; ">
            <table class="ve-table-content ve-table-border-x ve-table-border-y" id="vTable">
                <thead class="ve-table-fixed-header ve-table-header">
                <tr class="ve-table-header-tr">
                    <th class="ve-table-header-th" style="width: 100px;">
                        <div>日期</div>
                    </th>
                    <th class="ve-table-header-th" style="width: 250px;">游资</th>
                    <th class="ve-table-header-th" style="width: 140px;">个股</th>
                    <th class="ve-table-header-th" style="width: 190px;">行情</th>
                    <th class="ve-table-header-th" style="width: 220px;">资金流向</th>
                    <th class="ve-table-header-th" style="width: 160px;">龙虎榜</th>
                    <th class="ve-table-header-th" style="width: 300px;">上榜原因</th>
                </tr>
                </thead>
                <tbody id="sort" class="ve-table-body ve-table-stripe ve-table-row-hover ve-table-row-highlight">
                <tr style="height: 0px;"></tr>
                <tr class="ve-table-body-tr" style="width: 70px" v-for="col in tableData">
                    <td class="ve-table-body-td" style="text-align: center;">{{col.tradeDate}}</td>
                    <td class="ve-table-body-td" :class="col.stockCode" @mouseenter="isHover(col.stockCode)" @mouseleave="isLeave(col.stockCode)">
                        <div class="td-flex">
                            <span class="center" style="width: 100%; font-size: 16px;">{{col.partnerName}}</span>
                        </div>
                        <div class="td-flex">
                            <span class="center" style="width: 100%; font-size: 12px; color: red;">{{col.netBuyAmount}}  {{col.totalNetBuyRatio}} </span>
                        </div>
                    </td>
                    <td class="ve-table-body-td" v-for="(c, index) in col.stocks">
                        <div class="td-flex">
                            <a :href="'https://data.eastmoney.com/stockdata/'+col.stockCode+'.html'" target="_blank" style="color: #494949">
                                <span class="center" style="width: 65%; font-size: 20px; ">{{c.stockName}}</span>
                            </a>

                            <span class="center" style="width: 35%">{{c.freeMarketCap}}</span>
                        </div>
                        <div class="td-flex">
                            <span class="center" style="width: 50%; font-size: 15px;" :style="c.changePercent.startsWith('-') ? 'color: green' : 'color: red'">{{c.close}}</span>
                            <span class="center" style="width: 50%; font-size: 15px;" :style="c.changePercent.startsWith('-') ? 'color: green' : 'color: red'">{{c.changePercent}}</span>
                        </div>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const params = Object.fromEntries(urlParams.entries());
    console.log('urlParams:' + urlParams);
    console.log('params:' + params);

    // 异步请求函数必须要写在外面，然后在vue里面调用
    function asyncLoadDate() {
        axios.get(url + 'dragon/detail/partner/' + params.partnerCode).then(function (response) {
            if (response.status === 200) {
                vm.fillData(response);
            }
        }).catch(function (error) {
            alert("系统异常");
        });
    }

    var vm = new Vue({
        el: "#app",
        mounted: function () {
            asyncLoadDate();
        },
        methods: {
            fillData: function (response) {
                let json = response.data;
                this.tableData = json.data;
                // console.log(JSON.stringify(this.tableData))
            },
            isHover: function (stockCode) {
                document.getElementById('vTable').querySelectorAll('.' + stockCode).forEach(function (el) {
                    el.style.backgroundColor = 'yellow';
                });
            },
            isLeave: function (stockCode) {
                document.getElementById('vTable').querySelectorAll('.' + stockCode).forEach(function (el) {
                    el.style.backgroundColor = ''; // 或者设置回默认颜色或其他颜色
                });
            },
            //弹出隐藏层
            getJsonValue: function (json) {
                console.log(json)
            },
            showPartnerList: function () {
                MyDiv.style.width = '1400px';
                MyDiv.style.height = '725px';
                MyDiv.style.display = 'block';
                fade.style.display = 'block';
                MyDiv.innerHTML = '<object type="text/html" data="partner.html" width="100%" height="99%"></object>';
            },
        },
        data: function () {
            return {
                isDragging: true,
                dates: [],
                tableData: []
            };
        },
    });
</script>

</html>
